# CS-DownloadsCleaner 🧹

# 🛠 ダウンロードフォルダ大掃除ツール (C# お引越し版)！

「VBAで動いていたマクロを、モダンなC#へお引越し！」

かつてVBAの闇マクロとして作成したダウンロードフォルダ整理ツールを、勉強を兼ねてC#へ移植！
MS Officeがなくても動くので私のPCもお掃除してくれます。**やった～！**

VBA時代の「設計のこだわり」はそのままに、C#の強力な型システムと便利な標準ライブラリでさらにパワーアップしています。

## 🌟 これは何？
気付いたら第二のゴミ箱になりがちな「ダウンロード」フォルダの中身を、ルールに従って自動仕分けします。

- **整理階層**: デスクトップに「ダウンロード整理」フォルダを作成し、その中に実行日のフォルダ（`yyyyMMdd`）を作って仕分けます。デスクトップ直下じゃなくなってさらに便利になりました。うれし～！
- **安心設計**: 削除してよさそうなものも「削除予定」フォルダに突っ込むので、要らなかったら丸ごとゴミ箱にシュートしてください。
- **二重の優しさ**: 同名ファイルがある場合は、日付や連番を付与して上書きを防ぎます。

## 🏗 プロジェクト構成
VBA時代の「クラスモジュール」と「標準モジュール」の役割分担を、C#のディレクトリ構造とクラス設計に忠実にマッピングしました。

### 1. アプリケーションロジック (Core)
オブジェクト指向の設計パターン（Strategy & Factory）を採用しています。

| クラス名 | 役割 | 進化ポイント |
| :--- | :--- | :--- |
| **FileDTO** | ファイル情報の運び役 | **C#のFileInfoを活用。** 拡張子の小文字正規化や一時ファイルのバリデーションを初期化時に完結させます。 |
| **IFileAction** | アクションのインターフェース | すべての仕分けルールの「型」を定義。VBAのImplementsに相当するモノです。 |
| **ActionFactory** | インスタンス生成工場 | `static` クラスとして実装。拡張子を見て、C# 8.0のパターンマッチングで瞬時に適切なActionを生成します。 |
| **各Actionクラス** | 具体的な仕分け処理 | `exe`,`Zip`, `Pdf`, `Image`, `Music`, `Movie`, `Other` 用のアクションがあります。追加もかんたん！ |

### 2. 共通機能・ユーティリティ (Common)
VBAの標準モジュールで行っていた処理を、再利用性の高い静的クラスにまとめました。

| クラス名 | 役割 | 内容 |
| :--- | :--- | :--- |
| **FileUtility** | 共通ツール | `Path.Combine` を駆使した安全なパス結合、フォルダ生成、リネーム処理を担当。 |
| **ErrorManager** | エラーハンドリング | 累積エラー数による中断処理を管理。`static` なのでどこからでも報告可能です。わ～い！もう外部で`Attribute`いじらなくていいんだ！ |

## 🛠 C#化によるこだわりポイント
- **パス操作の堅牢化**: 文字列結合を卒業し、`System.IO.Path` クラスを使うことでOSに依存しない安全なパス操作を実現しました。
- **インターフェースによる拡張性**: `IFileAction` を継承するだけで、新しいファイル形式への対応も自由自在です。
- **モダンな文法**: switch式や自動実装プロパティ、null許容参照型の活用など、現代的なC#の書き方を取り入れています。冒険！

## 🚀 使い方
1. ZipがあるのでDLしてください。
2. 解凍して実行してください。
または
1. Visual Studio で `DownloadCleaner.slnx` を開きます。
2. ビルドして生成された `.exe` を実行します。
3. お掃除されて綺麗になってうれしいですね。やった～！

---
VBAからC#へ。大冒険の始まりをあなたは目撃しているのですよ。 🚀
